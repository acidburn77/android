From ea9e92b570053d3b4a26c610f4ba100c27a6bff9 Mon Sep 17 00:00:00 2001
From: milaq <micha.laqua@gmail.com>
Date: Fri, 12 Apr 2019 21:08:22 +0200
Subject: [PATCH] add ability to set the screen dim brightness to zero

handy for wall-mounted tablets in conjunction with the "screen will never sleep while plugged in" option to keep the
display on while letting the screen backlight turn off
---
 .../android/server/display/DisplayPowerController.java   | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)

diff --git a/services/core/java/com/android/server/display/DisplayPowerController.java b/services/core/java/com/android/server/display/DisplayPowerController.java
index 25e59d55341..a7ce7f4d6b8 100644
--- a/services/core/java/com/android/server/display/DisplayPowerController.java
+++ b/services/core/java/com/android/server/display/DisplayPowerController.java
@@ -37,6 +37,7 @@ import android.os.Message;
 import android.os.PowerManager;
 import android.os.RemoteException;
 import android.os.SystemClock;
+import android.os.SystemProperties;
 import android.os.Trace;
 import android.util.MathUtils;
 import android.util.Slog;
@@ -279,8 +280,12 @@ final class DisplayPowerController implements AutomaticBrightnessController.Call
         mScreenBrightnessDozeConfig = clampAbsoluteBrightness(resources.getInteger(
                 com.android.internal.R.integer.config_screenBrightnessDoze));
 
-        mScreenBrightnessDimConfig = clampAbsoluteBrightness(resources.getInteger(
-                com.android.internal.R.integer.config_screenBrightnessDim));
+        if (SystemProperties.getBoolean("persist.sys.screen_dim_zero", false)) {
+            mScreenBrightnessDimConfig = clampAbsoluteBrightness(0);
+        } else {
+            mScreenBrightnessDimConfig = clampAbsoluteBrightness(resources.getInteger(
+                    com.android.internal.R.integer.config_screenBrightnessDim));
+        }
 
         mScreenBrightnessDarkConfig = clampAbsoluteBrightness(resources.getInteger(
                 com.android.internal.R.integer.config_screenBrightnessDark));
-- 
2.21.0

